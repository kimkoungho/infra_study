# gcc 컴파일 옵션 
nginx 와 같은 패키지를 패키지 관리자인 yum 이 아닌 손수 소스 컴파일 하는경우 gcc 컴파일 로그가 출력됨   
개인적으로 각 로그에서 나오는 옵션들이 궁금해서 정리하게 됨  

## gcc 컴파일 옵션 
1. -Wall : 모든 모호한 코딩에 대해서 경고를 보내는 옵션
2. -W : 합법적이지만 모호한 코딩에 대해서 경로를 보내는 옵션
3. -E : 전처리 과정의 결과흘 화면에 출력하는 옵션 
4. -S : cc1 로 전처리된 파일을 어셈블리 파일로 컴파일까지 하고 멈추는 옵션
5. -c : as 에 의한 어셈브리까지만 수행하고 링크는 수행하지 않음 
6. -v : gcc 가 컴파일을 어떤식으로 수행하지를 화면에 출력 
7. --save-temps : 컴파일 과정에서 생성되는 중간 파일인 전처리 파일(*.i) 과 어셈블리 파일(*.s)를 지우지 않고, 현재 디렉토리에 저장
  
## cpp0 옵션
소스 내에서 사용된 헤더 파일과 define 매크로와 관련된 옵션들  
전처리 과정에서 오루가 발생한다면 cpp0 옵션을 점검해봐야 함  
1. -l : 전처리 과정에서 헤더 파일을 탐색하는 기본 디렉토리를 추가할 때 사용
2. -include : 헤더 파일을 소스내에 추가할 때 사용
3. -D\[매크로\] : 매크로를 외부에서 define 할 때 사용
4. -D\[매크로\]=\[매크로 값\] : 소스 내에 #define \[매크로\] \[매크로 값\] 옵션을 추가한 것과 동일
5. -U\[매크로\] : -D 옵션과 반대로 소스 파일 내에 #undef \[매크로\] 옵션을 추가한 것 
6. -M : make 를 위한 소스 파일의 모든 종속 항목을 출력
7. -MM : 기본 include 디레고티렝 있는 헤더 파일은 빼고 종속 항목을 출력 
8. -nostdinc : 디폴트 include 디렉토리 (/usr/include) 에서 헤더 파일을 탐색하지 않고, -l 옵션으로 추가한 디렉토리에서만 헤더 파일을 찾음 
9. -C : -E 옵션과 함께 사용되며, 전처리 과정에서 주석을 제거하지 않음
10. -Wp, \[옵션들\] : 만약 cpp0 과 gcc 옵션이 같은 것으로 중복되면 gcc 옵션으로 해석되므로 cpp0 옵션을 적용하기 위해서 gcc 해석을 거치지 않을 때 사용

## cc1 옵션
c 언어 옵션, 경고 옵션, 최적화 옵션, 디버깅 옵션 4가지로 구성됨  
경고 수위 조절, 최적화 수위 조절에 사용

### c 언어 옵션
c 언어 종류와 표준에 관련된 옵션 
1. -ansi : ANSI C 표준에 부합하는 소스를 작성하고자 할 때 사용하는 옵션 
2. -std=[c 표준] : 기타 다른 표준들을 지정하고자 할 때 사용하는 옵션 
3. -traditional : 오래된 Traditional C 문법으로 검사
4. -fno -asm : gnu89 문법을 바탕으로 asm, inline, typeof 키워드를 사용하지 않기를 원할 때 사용

### 경고 옵션
cc1 의 옵션을 조정하여 경고 수위를 조절
1. -W / -Wall : gcc 옵션과 동일
2. -w : 모든 경고 메시지를 제거
3. -Werror : 모든 경로를 컴파일을 중단하는 오류로 취급 
4. -pedantic : ANSI C89 표준에서 요구하는 모든 경고 메시지를 표시
5. -pedantic-error : ANSI C89 표준에서 요구하는 모든 오류 메시지를 표시 
6. -Wtraditional : 소스가 ANSI C와 K&R C 간에 서로 다른 결과를 가져 올 수 있는 부분이 있다면 경고 

### 최적화 옵션 
실행 파일의 크기를 줄여 메모리와 하드 디스크의 사이즈를 절약함  
실행 파일의 크기를 줄여서 실행 속도를 향상  
1. -O0 : 최적화를 수행하지 않음 
2. -O1 : -O0 보다 조금 낳은 최적화
3. -O2 : 가장 많이 사용하는 옵션으로 일반 응용 프로그램이나 커널을 컴파일 할 때 사용 (대부분 최적화를 수행)
4. -O3 : 가장 높은 레벨의 최적화를 사용하는 것으로 모든 함수를 인라인 함수와 같이 취급   
    많은 소스의 변경이 일어남으로 왜곡이 발생할 수 있음 
5. -O5 : 사이즈 최적화를 실행 (임베디드 시스템)

### 디버깅 옵션
1. -g : gdb 에게 제공하는 정보를 바이너리에 삽입
2. -pg : 프로파일을 위한 코드를 삽입 

## 링크 옵션 
1. -L \[라이브 디렉토리\] : 라이브러리를 찾을 디렉토리를 지정
2. -l : 같이 링크할 라이브러리를 지정
3. -shared : 공유 라이브러리와 정적 라이브러리가 같이 있을 경우, 공유 라이브러리를 우선하여 링크 (기본값)
4. -static : 정적 라이브러리와 공유 라이브러리 중 정적 라이브러리를 우선하는 옵션 
5. -nostdlib : 링크시에 표준 C 라이브러리를 사용하지 않음 (부트로더 컴파일에 사용)
6. -nostartfiles : crt1.o 와 같은 start up 파일을 링크하지 않음 (부트로더 컴파일에 사용)
7. -Wl, \[링크\] : gcc 를 거치지 않고 바로 링크에게 옵션을 정해줄 때 사용 

## 래퍼런스 
- [티스토리 gcc 컴파일러](https://dany-it.tistory.com/213)